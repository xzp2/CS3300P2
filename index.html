<html>
<head>
<script src="http://d3js.org/d3.v3.min.js"></script>
<script src="http://d3js.org/topojson.v1.min.js"></script>
<link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Oswald' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Amatic+SC' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Josefin+Slab' rel='stylesheet' type='text/css'>
<style>
body{
  background: #333;
}
h1 {
  color: #85ce18;
  font: 80px 'Amatic SC';
  /*text-transform: uppercase;*/
  font-weight:bold;
  text-align: center;
}
h2 {
  text-align:center;
  color: #cef424;
  margin-top:-45px;
  text-transform: uppercase;
  font: 25px 'Josefin Slab';
  font-weight:bold;
}
.background {
  fill: #333;
}
#states {
  fill: #eee;
}
#state-borders {
  fill: none;
  stroke: #aaa;
  stroke-width: 1.5px;
}
.state:hover{
  fill: #111;
}
div.tooltip {
  position: absolute;
  text-align: center;
  width: 60px;
  height: 12px;
  padding: 8px;
  margin-top: -20px;
  font: 20px 'Open Sans';
  background: #ea9905;
  outline: 1px solid #b27101;
}

</style>
</head>
<body>
  <h1>The Bigfoot Phenomenon</h1>
  <h2>debunking popular myths or something</h2>



<form class="one"><input type="button" value="Population" onclick="setMap('pop');"></input></form>

<form class="two"><input type="button" value="Average Temperature" onclick="setMap('temp');"></input></form>

<form class="three"><input type="button" value="Mean Elevation" onclick="setMap('elev');"></input></form>

<form class="four"><input type="button" value="Average Rainfall" onclick="setMap('rain');"></input></form>

<form class="five"><input type="button" value="% Forest Cover" onclick="setMap('forest');"></input></form>

<form class="six"><input type="button" value="% of Population That Has Used Marijuana At Least Once" onclick="setMap('drug');"></input></form>

<form class="seven"><input type="button" value="Something Alcohol" onclick="setMap('alcohol');"></input></form>

<form class="eight"><input type="button" value="% Urban Area" onclick="setMap('urban');"></input></form>
<script>
var names;
var width = 900,
    height = 600,
    active = d3.select(null);
var projection = d3.geo.albersUsa()
    .scale(1070)
    .translate([width / 2, height / 2]);
var path = d3.geo.path()
    .projection(projection);
var svg = d3.select("body").append("svg")
    .attr("width", width)
    .attr("height", height);
svg.append("rect")
    .attr("class", "background")
    .attr("width", width)
    .attr("height", height);
var g = svg.append("g");
var hover = d3.select('body').append('div')
            .attr('class', 'tooltip')
            .style('opacity', 0);
d3.json("us.json", function(error, us) {
  names = us;
  g.append("g")
  .attr("id", "states")
  .selectAll("path")
  .data(topojson.feature(us, us.objects.states).features)
  .enter().append("path")
  .attr("d", path)
  .attr("class", "state")
  .on("mousemove", function(d) {
    hover.style("opacity", .9);
    hover.classed('hidden', false)
    //.style("left", (d3.event.pageX) + "px"  )
    //.style("top", (d3.event.pageY - 25) + "px")
    .style("left", "65%")
    .style("top", "30%")
    .style("height", "60%")
    .style("width", "25%")
    .html(
      "<b>State:</b> " + d.properties.stateName + 
      "<br/><b>Number of Sightings:</b> " + d.properties.numSight + 
      "<br/><b>Most recent report:</b> " + d.properties.mostRecent + 
      "<br/> <br/> <u>Demographics</u><br/> <br/><b>Population:</b> " + d.properties.Pop + 
      "<br/><b>Avg. Annual Temp. (F):</b> " + d.properties.Temp + 
      "<br/><b>Avg. Elevation:</b> " + d.properties.Elev + 
      "<br/><b>Avg. Rainfall:</b> " + d.properties.Rain + 
      "<br/><b>Avg. Forest Cover:</b> " + d.properties.Forest + 
      "<br/><b>Drug Usage:</b> " + d.properties.Drug + 
      "<br/><b>Alcohol Usage:</b> " + d.properties.Alcohol + 
      "<br/><b>Percent Urban Area:</b> " + d.properties.urbArea+ "");  
    })
  .on("mouseout", function() {
    hover.attr("style", "opacity:0");
    });
  g.append("path")
      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
      .attr("id", "state-borders")
      .attr("d", path);
});

function reset(){
  d3.select("svg").remove();

  svg = d3.select("body").append("svg")
    .attr("width", width)
    .attr("height", height);
  svg.append("rect")
    .attr("class", "background")
    .attr("width", width)
    .attr("height", height);
  g = svg.append("g");
  hover = d3.select('body').append('div')
    .attr('class', 'tooltip')
    .style('opacity', 0);
}

function getColor(type, val){
  if(type=="pop"){
    var colorScale = d3.scale.linear().domain([400000, 40000000]).range(["#ffffff", "#ff0000"]);
    return colorScale(val);
  }
  else if(type=="temp"){
    var colorScale = d3.scale.linear().domain([25, 70]).range(["#0000ff", "#ff0000"]);
    return colorScale(val);
  }
  else if(type=="elev"){
    var colorScale = d3.scale.linear().domain([50, 7000]).range(["#F4A460", "#5E2612"]);
    return colorScale(val);
  }
  else if(type=="rain"){
    var colorScale = d3.scale.linear().domain([5, 65]).range(["#ffffff", "#0000ff"]);
    return colorScale(val);
  }
  else if(type=="forest"){
    var colorScale = d3.scale.linear().domain([10, 80]).range(["#ffffff", "#2E8B57"]);
    return colorScale(val);
  }
  else if(type=="drug"){
    var colorScale = d3.scale.linear().domain([35, 70]).range(["#ffffff", "#8B008B"]);
    return colorScale(val);
  }
  else if(type=="alcohol"){
    var colorScale = d3.scale.linear().domain([1, 4]).range(["#ffffff", "#9C661F"]);
    return colorScale(val);
  }
  else if(type=="urban"){
    var colorScale = d3.scale.linear().domain([0, 40]).range(["#ffffff", "#8E8E38"]);
    return colorScale(val);
  }

}

function setMap(type){
  
  reset();
  d3.json("us.json", function(error, us) {
  names = us;
  g.append("g")
  .attr("id", "states")
  .selectAll("path")
  .data(topojson.feature(us, us.objects.states).features)
  .enter().append("path")
  .attr("d", path)
  .attr("fill",function(d){
    if(type=='pop') {return getColor(type,d.properties.Pop);}
    else if(type=='temp'){return getColor(type,d.properties.Temp);}
    else if(type=='elev'){return getColor(type,d.properties.Elev);}
    else if(type=='rain'){return getColor(type,d.properties.Rain);}
    else if(type=='forest'){return getColor(type,d.properties.Forest);}
    else if(type=='drug'){return getColor(type,d.properties.Drug);}
    else if(type=='alcohol'){return getColor(type,d.properties.Alcohol);}
    else if(type=='urban'){return getColor(type,d.properties.urbArea);}
    else{return "#eee";}
  })
  .attr("class", "state")
  .on("mousemove", function(d) {
    hover.style("opacity", .9);
    hover.classed('hidden', false)
    //.style("left", (d3.event.pageX) + "px"  )
    //.style("top", (d3.event.pageY - 25) + "px")
    .style("left", "65%")
    .style("top", "30%")
    .style("height", "60%")
    .style("width", "25%")
    .html(
      "<b>State:</b> " + d.properties.stateName + 
      "<br/><b>Number of Sightings:</b> " + d.properties.numSight + 
      "<br/><b>Most recent report:</b> " + d.properties.mostRecent + 
      "<br/> <br/> <u>Demographics</u><br/> <br/><b>Population:</b> " + d.properties.Pop + 
      "<br/><b>Avg. Annual Temp. (F):</b> " + d.properties.Temp + 
      "<br/><b>Avg. Elevation:</b> " + d.properties.Elev + 
      "<br/><b>Avg. Rainfall:</b> " + d.properties.Rain + 
      "<br/><b>Avg. Forest Cover:</b> " + d.properties.Forest + 
      "<br/><b>Drug Usage:</b> " + d.properties.Drug + 
      "<br/><b>Alcohol Usage:</b> " + d.properties.Alcohol + 
      "<br/><b>Percent Urban Area:</b> " + d.properties.urbArea+ "");  
    })
  .on("mouseout", function() {
    hover.attr("style", "opacity:0");
    });
  g.append("path")
      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
      .attr("id", "state-borders")
      .attr("d", path);
});
}


</script>
</body>
</html>